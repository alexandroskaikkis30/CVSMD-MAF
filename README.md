# CV-SMD/MAF
This project investigates the non-equilibrium mechanical unfolding of the villin headpiece (PDB: 2RJY) using TorchMD framework to perform constant-velocity steered molecular dynamics simulations. Conditional Masked Autoregressive Flow (MAF) models were trained on trajectory data conditioned on physical observables such as molecular extension and pulling force.

# Overview
This study explores the non-equilibrium mecahnical unfolding of villin headpiece (PDB: 2RJY) by employing steered molecular dynamics simulations using the constant-velocity pulling method, through the TorchMD framework. A pulling protocol similar to that described by Bustamante et al. (2020) in Single-Molecule Studies of Protein Folding with Optical Tweezers was implemented. In this CV-SMD configuration, the pulling mechanism is defined by two reference points that move in opposite directions along the x-axis at constant velocity. Each of the two terminal atoms is harmonically restrained to one of these moving reference points, generating time-dependent forces that drive the unfolding process. This configuration is designed to mimic the physical conditions of Bustamante’s optical tweezers experiment, which is performed in a thermal bath allowing continuous energy exchange between the system and its environment. In TorchMD, temperature control required for the canonical (NVT) ensemble is achieved through its built-in integrator class, and a Langevin integrator was employed to maintain constant temperature throughout the simulation.

Several constant-velocity steered molecular dynamics (CV-SMD) simulations were performed at different pulling velocities. Analysis of the resulting force–extension profiles revealed noise associated with the sampling of similar conformations throughout the trajectories, while fewer samples were observed during unfolding events. These unfolding events correspond primarily to the disruption of secondary structure elements (α-helices) within the villin headpiece. 
<img width="1311" height="698" alt="image" src="https://github.com/user-attachments/assets/fa0a26e2-b5d1-48bc-83fd-2fcb5f349c0a" />

To better capture and generate such rare conformational states, a conditional normalising flow model was employed, specifically a Conditional Masked Autoregressive Flow (MAF).
